<!DOCTYPE html>  <html> <head>   <title>app-all-in-one.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               app-all-in-one.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <h3>To see this thing in action, check out <a href="demo/index.html">this demo</a>!</h3>             </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h1>Services.</h1>

<p>A <code>service</code> is a once-instantiated, injectable dependency.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <h3>Service: User</h3>

<p><code>User</code> is a service that will handle the functionality of logging a user
in and out. Note that it lists <code>Store</code> in the signature of the function.
This will be caught by <code>things</code> and injected into the function when it is
called.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">things</span><span class="p">(</span><span class="s1">&#39;myApp&#39;</span><span class="p">).</span><span class="nx">service</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Store</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">loggedIn</span> <span class="o">=</span> <span class="o">!!</span><span class="nx">Store</span><span class="p">.</span><span class="nx">getItem</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">);</span>

    <span class="kd">var</span> <span class="nx">isLoggedIn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">loggedIn</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">logIn</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">username</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">Store</span><span class="p">.</span><span class="nx">setItem</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">,</span> <span class="nx">username</span><span class="p">);</span>

      <span class="nx">loggedIn</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="kd">var</span> <span class="nx">logOut</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">Store</span><span class="p">.</span><span class="nx">removeItem</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">);</span>

      <span class="nx">loggedIn</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>We are returning an object literal, limiting access to the above inner-
workings. Remember this style when we get to the upcoming <code>Store</code>
service.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="p">{</span>
      <span class="nx">isLoggedIn</span><span class="o">:</span> <span class="nx">isLoggedIn</span><span class="p">,</span>
      <span class="nx">logIn</span><span class="o">:</span> <span class="nx">logIn</span><span class="p">,</span>
      <span class="nx">logOut</span><span class="o">:</span> <span class="nx">logOut</span>
    <span class="p">};</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <h3>Service: Store</h3>

<p><code>Store</code> is a localStorage-y bucket that you can drop things in for the life
of the session.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">things</span><span class="p">(</span><span class="s1">&#39;myApp&#39;</span><span class="p">).</span><span class="nx">service</span><span class="p">(</span><span class="s1">&#39;Store&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">Feature</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">Feature</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Feature</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">;</span>
    <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Note that inside of this <code>service</code>, we're making use of <code>this</code>. Any
<code>service</code> function you create will be <code>new</code>'d, to cater to your
preferred style of writing.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">Store</span> <span class="o">=</span> <span class="p">{};</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">setItem</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">Store</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
    <span class="p">};</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">getItem</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">return</span> <span class="nx">Store</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
    <span class="p">};</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">removeItem</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">delete</span> <span class="nx">Store</span><span class="p">[</span><span class="nx">name</span><span class="p">];</span>
    <span class="p">};</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <h3>Service: Feature</h3>

<p>Let's add one more <code>service</code>, called <code>Feature</code>. This can be used to do a
quick check for what features the user's browser and device support.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">things</span><span class="p">(</span><span class="s1">&#39;myApp&#39;</span><span class="p">).</span><span class="nx">service</span><span class="p">(</span><span class="s1">&#39;Feature&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">root</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">localStorage</span> <span class="o">=</span> <span class="nx">root</span><span class="p">.</span><span class="nx">localStorage</span><span class="p">;</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <h1>Things.</h1>

<p>When what you want to create isn't a <code>service</code>, or a <code>route</code>, you might be
best off creating a <code>thing</code>. These can be functions, arrays, numbers, etc.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <h3>Thing: States</h3>

<p>This <code>thing</code> called <code>States</code> will just return an array when summoned by
a function.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">things</span><span class="p">(</span><span class="s1">&#39;myApp&#39;</span><span class="p">).</span><span class="nx">thing</span><span class="p">(</span><span class="s1">&#39;States&#39;</span><span class="p">,</span> <span class="p">[</span>
    <span class="s1">&#39;Alabama&#39;</span><span class="p">,</span> <span class="s1">&#39;Alaska&#39;</span><span class="p">,</span> <span class="s1">&#39;Arizona&#39;</span><span class="p">,</span> <span class="s1">&#39;Arkansas&#39;</span><span class="p">,</span> <span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="s1">&#39;Colorado&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Connecticut&#39;</span><span class="p">,</span> <span class="s1">&#39;Delaware&#39;</span><span class="p">,</span> <span class="s1">&#39;Florida&#39;</span><span class="p">,</span> <span class="s1">&#39;Georgia&#39;</span><span class="p">,</span> <span class="s1">&#39;Hawaii&#39;</span><span class="p">,</span> <span class="s1">&#39;Idaho&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Illinois&#39;</span><span class="p">,</span> <span class="s1">&#39;Indiana&#39;</span><span class="p">,</span> <span class="s1">&#39;Iowa&#39;</span><span class="p">,</span> <span class="s1">&#39;Kansas&#39;</span><span class="p">,</span> <span class="s1">&#39;Kentucky&#39;</span><span class="p">,</span> <span class="s1">&#39;Louisiana&#39;</span><span class="p">,</span> <span class="s1">&#39;Maine&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Maryland&#39;</span><span class="p">,</span> <span class="s1">&#39;Massachusetts&#39;</span><span class="p">,</span> <span class="s1">&#39;Michigan&#39;</span><span class="p">,</span> <span class="s1">&#39;Minnesota&#39;</span><span class="p">,</span> <span class="s1">&#39;Mississippi&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Missouri&#39;</span><span class="p">,</span> <span class="s1">&#39;Montana&#39;</span><span class="p">,</span> <span class="s1">&#39;Nebraska&#39;</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">,</span> <span class="s1">&#39;New Hampshire&#39;</span><span class="p">,</span> <span class="s1">&#39;New Jersey&#39;</span><span class="p">,</span>
    <span class="s1">&#39;New Mexico&#39;</span><span class="p">,</span> <span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;North Carolina&#39;</span><span class="p">,</span> <span class="s1">&#39;North Dakota&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Oklahoma&#39;</span><span class="p">,</span> <span class="s1">&#39;Oregon&#39;</span><span class="p">,</span> <span class="s1">&#39;Pennsylvania&#39;</span><span class="p">,</span> <span class="s1">&#39;Rhode Island&#39;</span><span class="p">,</span> <span class="s1">&#39;South Carolina&#39;</span><span class="p">,</span>
    <span class="s1">&#39;South Dakota&#39;</span><span class="p">,</span> <span class="s1">&#39;Tennessee&#39;</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">,</span> <span class="s1">&#39;Utah&#39;</span><span class="p">,</span> <span class="s1">&#39;Vermont&#39;</span><span class="p">,</span> <span class="s1">&#39;Virginia&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Washington&#39;</span><span class="p">,</span> <span class="s1">&#39;West Virginia&#39;</span><span class="p">,</span> <span class="s1">&#39;Wisconsin&#39;</span><span class="p">,</span> <span class="s1">&#39;Wyoming&#39;</span>
  <span class="p">]);</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <h1>Routes.</h1>

<p>A <code>route</code> is like a "page" of your app. The function in here is called
when you or your user asks to <code>goTo</code> it.</p>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <h3>Route: /</h3>

<p>The first parameter to a <code>route</code> is the "path" to your app. This route
will be our homepage.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">things</span><span class="p">(</span><span class="s1">&#39;myApp&#39;</span><span class="p">).</span><span class="nx">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">User</span><span class="p">,</span> <span class="nx">$el</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>We're asking for <code>User</code> and <code>$el</code>. Remember that <code>User</code> is the <code>service</code>
we created earlier. <code>$el</code> is something new.</p>

<p>Each <code>route</code> should also match an element in your HTML markup. These
routes are identified by a custom, <code>[data-route]</code> data attribute.</p>

<p>For this route, this is what you'll find in <code>index.html</code>:</p>

<pre><code>&lt;section data-route="/"&gt;&lt;/section&gt;
</code></pre>

<p>So, what <code>$el</code> gives us, is access to that DOM element, wrapped with some
extra functionality. We use that here to update the innerHTML of the
above element.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">User</span><span class="p">.</span><span class="nx">isLoggedIn</span><span class="p">())</span> <span class="p">{</span>
      <span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;Ha! You\&#39;re not logged in.&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <h3>Route: /login</h3>

<p>This <code>/login</code> route will be called later to simulate logging a user in.
The <code>/login</code> element from index.html looks like this:</p>

<pre><code>&lt;section data-route="/login"&gt;
  &lt;form&gt;
    &lt;input placeholder="username, please."&gt;
    &lt;button&gt;Submit&lt;/button&gt;
  &lt;/form&gt;
  &lt;div data-el&gt;&lt;/div&gt;
&lt;/section&gt;
</code></pre>

<p>We've added something new here. You can create an element with a <code>data-el</code>
data attribute, and in turn, this is what will be injected when asked for
<code>$el</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">things</span><span class="p">(</span><span class="s1">&#39;myApp&#39;</span><span class="p">).</span><span class="nx">route</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">User</span><span class="p">,</span> <span class="nx">$el</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">User</span><span class="p">.</span><span class="nx">logIn</span><span class="p">(</span><span class="s1">&#39;stephen&#39;</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">User</span><span class="p">.</span><span class="nx">isLoggedIn</span><span class="p">())</span> <span class="p">{</span>
      <span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="s1">&#39;Thanks for logging in! You\&#39;ll be re-directed momentarily.&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <h3>Route: /logout</h3>

<p><code>/logout</code> will simulate logging our user out. It also makes use of a new
<code>goTo</code> function.</p>

<p><code>goTo</code> is provided by <code>things</code> out of the box. It is what you will use to
move your user around throughout your app.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">things</span><span class="p">(</span><span class="s1">&#39;myApp&#39;</span><span class="p">).</span><span class="nx">route</span><span class="p">(</span><span class="s1">&#39;/logout&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">User</span><span class="p">,</span> <span class="nx">goTo</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">User</span><span class="p">.</span><span class="nx">logOut</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">User</span><span class="p">.</span><span class="nx">isLoggedIn</span><span class="p">())</span> <span class="p">{</span>
      <span class="nx">goTo</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <h3>Route: /usa</h3>

<p><code>/usa</code> is probably the most useful page ever created. We will request that
<code>States</code> <code>thing</code> we created earlier (an array), and turn it into a lovely
paragraph.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">things</span><span class="p">(</span><span class="s1">&#39;myApp&#39;</span><span class="p">).</span><span class="nx">route</span><span class="p">(</span><span class="s1">&#39;/usa&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$el</span><span class="p">,</span> <span class="nx">States</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">States</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">));</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <h1>Boots.</h1>

<p>Pass a function to <code>boots</code> that will execute when the document has finished
loading. Note that we're asking for <code>root</code> here, which is another default
dependency provided by <code>things</code>, that refers to the global, <code>window</code>
object.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">things</span><span class="p">(</span><span class="s1">&#39;myApp&#39;</span><span class="p">).</span><span class="nx">boots</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">root</span><span class="p">,</span> <span class="nx">goTo</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">goTo</span><span class="p">(</span><span class="s1">&#39;/logout&#39;</span><span class="p">);</span>

    <span class="nx">goTo</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">);</span>

    <span class="nx">root</span><span class="p">.</span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">goTo</span><span class="p">(</span><span class="s1">&#39;/login&#39;</span><span class="p">);</span>
    <span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>

    <span class="nx">root</span><span class="p">.</span><span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">goTo</span><span class="p">(</span><span class="s1">&#39;/usa&#39;</span><span class="p">);</span>
    <span class="p">},</span> <span class="mi">4000</span><span class="p">);</span>
  <span class="p">});</span>
<span class="p">})();</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html>
